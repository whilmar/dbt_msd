{"type": "Union","this": {"type": "Union","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "external_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "rec_no","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "name","quoted": "False"},"table": {"type": "Identifier","this": "SU","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "study_no","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "name","quoted": "False"},"table": {"type": "Identifier","this": "SI","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "site_no","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "name","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "sbjct_no","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "country_name","quoted": "False"},"table": {"type": "Identifier","this": "icv","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "site_cntry","quoted": "False"}},{"type": "Alias","this": {"type": "Case","this": "None","ifs": [{"type": "If","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "SUBJECT_STATUS","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "COMPLETED","is_string": "True"}},"true": {"type": "Literal","this": "Completed","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "SCREENING NOT COMPLETED","is_string": "True"}},"true": {"type": "Literal","this": "Limited Screen Failure","is_string": "True"}},{"type": "If","this": {"type": "And","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason_category","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "DISCONTINUED","is_string": "True"}},"expression": {"type": "NEQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "SCREEN FAILURE","is_string": "True"}}},"true": {"type": "Literal","this": "Early Terminated","is_string": "True"}},{"type": "If","this": {"type": "And","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason_category","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "DISCONTINUED","is_string": "True"}},"expression": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "SCREEN FAILURE","is_string": "True"}}},"true": {"type": "Literal","this": "Screen Failed","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "SUBJECT_STATUS","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "RANDOMIZED/TREATED","is_string": "True"}},"true": {"type": "Literal","this": "Randomized/Treated","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "SUBJECT_STATUS","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "SCREENED","is_string": "True"}},"true": {"type": "Literal","this": "In Screening","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "SUBJECT_STATUS","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "N/A","is_string": "True"}},"true": {"type": "Column","this": {"type": "Identifier","this": "subject_status_change","quoted": "False"},"table": {"type": "Identifier","this": "subject_status","quoted": "False"},"db": "None","catalog": "None"}}],"default": {"type": "Column","this": {"type": "Identifier","this": "SUBJECT_STATUS","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"alias": {"type": "Identifier","this": "sbjct_sts","quoted": "False"}},{"type": "Alias","this": {"type": "Case","this": "None","ifs": [{"type": "If","this": {"type": "GT","this": {"type": "Anonymous","this": "regexp_count","expressions": [{"type": "Paren","this": {"type": "Substring","this": {"type": "Column","this": {"type": "Identifier","this": "study_cohort","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"},"start": {"type": "Literal","this": "1","is_string": "False"},"length": {"type": "Literal","this": "3","is_string": "False"}}},{"type": "Literal","this": "x","is_string": "True"}]},"expression": {"type": "Literal","this": "2","is_string": "False"}},"true": {"type": "Null"}}],"default": {"type": "Column","this": {"type": "Identifier","this": "study_cohort","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"alias": {"type": "Identifier","this": "cohort_sbjct_grp","quoted": "False"}},{"type": "Alias","this": {"type": "Case","this": "None","ifs": [{"type": "If","this": {"type": "GT","this": {"type": "Anonymous","this": "regexp_count","expressions": [{"type": "Paren","this": {"type": "Substring","this": {"type": "Column","this": {"type": "Identifier","this": "study_arm","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"},"start": {"type": "Literal","this": "1","is_string": "False"},"length": {"type": "Literal","this": "3","is_string": "False"}}},{"type": "Literal","this": "x","is_string": "True"}]},"expression": {"type": "Literal","this": "2","is_string": "False"}},"true": {"type": "Null"}}],"default": {"type": "Column","this": {"type": "Identifier","this": "study_arm","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"alias": {"type": "Identifier","this": "arm_sbjct_grp","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_visit_mode","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "vst_srv_mod","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_visit_location","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "vst_srv_loc","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_visit_srv_prov","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "vst_srv_prov","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "event_name","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "mlstn_id","quoted": "False"}},{"type": "Alias","this": {"type": "Cast","this": {"type": "Column","this": {"type": "Identifier","this": "occurred_on_date","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"to": {"type": "DataType","this": "Type.DATE","expressions": "None","nested": "False","prefix": "None"},"format": "None","safe": "None","action": "None"},"alias": {"type": "Identifier","this": "mlstn_compl_dt","quoted": "False"}},{"type": "Alias","this": {"type": "Case","this": "None","ifs": [{"type": "If","this": {"type": "And","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "event_name","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "UNSCHEDULED VISIT","is_string": "True"}},"expression": {"type": "In","this": {"type": "Bracket","this": {"type": "Bracket","this": {"type": "Column","this": {"type": "Identifier","this": "source_data","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expressions": [{"type": "Literal","this": "0","is_string": "False"}]},"expressions": [{"type": "Literal","this": "name","is_string": "True"}]},"expressions": [{"type": "Literal","this": "dmw_clbfm","is_string": "True"},{"type": "Literal","this": "dmw_vs02fm","is_string": "True"}]}},"true": {"type": "Literal","this": "Complete","is_string": "True"}},{"type": "If","this": {"type": "Or","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_visit_mode","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "TELEPHONE CALL","is_string": "True"}},"expression": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_visit_mode","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "VIRTUAL","is_string": "True"}}},"true": {"type": "Literal","this": "Complete","is_string": "True"}},{"type": "If","this": {"type": "And","this": {"type": "GT","this": {"type": "Paren","this": {"type": "Dot","this": {"type": "Bracket","this": {"type": "ArrayFilter","this": {"type": "Dot","this": {"type": "Bracket","this": {"type": "ArrayFilter","this": {"type": "Column","this": {"type": "Identifier","this": "source_data","quoted": "False"}},"expression": {"type": "Lambda","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Dot","this": {"type": "Identifier","this": "sd","quoted": "False"},"expression": {"type": "Identifier","this": "name","quoted": "False"}}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "DMW_DOVFM","is_string": "True"}},"expressions": [{"type": "Identifier","this": "sd","quoted": "False"}]}},"expressions": [{"type": "Literal","this": "0","is_string": "False"}]},"expression": {"type": "Identifier","this": "data","quoted": "False"}},"expression": {"type": "Lambda","this": {"type": "EQ","this": {"type": "Dot","this": {"type": "Identifier","this": "data","quoted": "False"},"expression": {"type": "Identifier","this": "attribute","quoted": "False"}},"expression": {"type": "Literal","this": "ttl_vst_cnt","is_string": "True"}},"expressions": [{"type": "Identifier","this": "data","quoted": "False"}]}},"expressions": [{"type": "Literal","this": "0","is_string": "False"}]},"expression": {"type": "Identifier","this": "value","quoted": "False"}}},"expression": {"type": "Literal","this": "0","is_string": "False"}},"expression": {"type": "Paren","this": {"type": "Or","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "sdv_mode","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "IN PERSON","is_string": "True"}},"expression": {"type": "Is","this": {"type": "Column","this": {"type": "Identifier","this": "sdv_mode","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Null"}}}}},"true": {"type": "Literal","this": "Complete","is_string": "True"}},{"type": "If","this": {"type": "And","this": {"type": "GT","this": {"type": "Paren","this": {"type": "Dot","this": {"type": "Bracket","this": {"type": "ArrayFilter","this": {"type": "Dot","this": {"type": "Bracket","this": {"type": "ArrayFilter","this": {"type": "Column","this": {"type": "Identifier","this": "source_data","quoted": "False"}},"expression": {"type": "Lambda","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Dot","this": {"type": "Identifier","this": "sd","quoted": "False"},"expression": {"type": "Identifier","this": "name","quoted": "False"}}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "DMRC_CV_DOVFM","is_string": "True"}},"expressions": [{"type": "Identifier","this": "sd","quoted": "False"}]}},"expressions": [{"type": "Literal","this": "0","is_string": "False"}]},"expression": {"type": "Identifier","this": "data","quoted": "False"}},"expression": {"type": "Lambda","this": {"type": "EQ","this": {"type": "Dot","this": {"type": "Identifier","this": "data","quoted": "False"},"expression": {"type": "Identifier","this": "attribute","quoted": "False"}},"expression": {"type": "Literal","this": "ttl_vst_cnt","is_string": "True"}},"expressions": [{"type": "Identifier","this": "data","quoted": "False"}]}},"expressions": [{"type": "Literal","this": "0","is_string": "False"}]},"expression": {"type": "Identifier","this": "value","quoted": "False"}}},"expression": {"type": "Literal","this": "0","is_string": "False"}},"expression": {"type": "Paren","this": {"type": "Or","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "sdv_mode","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "IN PERSON","is_string": "True"}},"expression": {"type": "Is","this": {"type": "Column","this": {"type": "Identifier","this": "sdv_mode","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Null"}}}}},"true": {"type": "Literal","this": "Complete","is_string": "True"}}],"default": {"type": "Literal","this": "In progress","is_string": "True"}},"alias": {"type": "Identifier","this": "mlstn_stat","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "erroneous_visit","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "erroneous_rec","quoted": "False"}},{"type": "Alias","this": {"type": "Case","this": "None","ifs": [{"type": "If","this": {"type": "Is","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "erroneous_visit","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Null"}},"true": {"type": "Literal","this": "Insert","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "erroneous_visit","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "ERRONEOUS VISIT","is_string": "True"}},"true": {"type": "Literal","this": "Reverse","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Literal","this": "1","is_string": "True"}},"true": {"type": "Literal","this": "Reverse","is_string": "True"}}],"default": "None"},"alias": {"type": "Identifier","this": "rec_sts","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "event_type","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "rec_typ","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "src_sys_nm","quoted": "False"}},{"type": "Alias","this": {"type": "Bracket","this": {"type": "Bracket","this": {"type": "Column","this": {"type": "Identifier","this": "source_data","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expressions": [{"type": "Literal","this": "0","is_string": "False"}]},"expressions": [{"type": "Column","this": {"type": "Identifier","this": "name","quoted": "True"}}]},"alias": {"type": "Identifier","this": "src_tbl_nm","quoted": "False"}},{"type": "Alias","this": {"type": "Cast","this": {"type": "Case","ifs": [{"type": "If","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Literal","this": "0","is_string": "False"}},"true": {"type": "Literal","this": "true","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Literal","this": "1","is_string": "False"}},"true": {"type": "Literal","this": "false","is_string": "True"}}],"default": "None"},"to": {"type": "DataType","this": "Type.BOOLEAN","expressions": "None","nested": "False","prefix": "None"}},"alias": {"type": "Identifier","this": "actv_flag","quoted": "False"}},{"type": "Alias","this": {"type": "Cast","this": {"type": "Column","this": {"type": "Identifier","this": "config_subitem_nm","quoted": "False"},"table": {"type": "Identifier","this": "x","quoted": "False"},"db": "None","catalog": "None"},"to": {"type": "DataType","this": "Type.TEXT","expressions": "None","nested": "False","prefix": "None"}},"alias": {"type": "Identifier","this": "crtd_by_id","quoted": "False"}},{"type": "Alias","this": {"type": "Anonymous","this": "to_timestamp","expressions": [{"type": "Column","this": {"type": "Identifier","this": "src_created_by_date","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},{"type": "Literal","this": "yyyy-MM-dd hh:mm:ss","is_string": "True"}]},"alias": {"type": "Identifier","this": "crtd_on_ts","quoted": "False"}},{"type": "Alias","this": {"type": "Anonymous","this": "to_timestamp","expressions": [{"type": "Greatest","this": {"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expressions": [{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "SU","quoted": "False"},"db": "None","catalog": "None"},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "si","quoted": "False"},"db": "None","catalog": "None"},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "LOC","quoted": "False"},"db": "None","catalog": "None"}]},{"type": "Literal","this": "yyyy-MM-dd hh:mm:ss","is_string": "True"}]},"alias": {"type": "Identifier","this": "chgd_on_ts","quoted": "False"}},{"type": "Alias","this": {"type": "CurrentTimestamp"},"alias": {"type": "Identifier","this": "etl_load_ts","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_aux_del_unscheduled_visit","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "CTE","quoted": "False"},"columns": "None"}}},"joins": [{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "b2p_config_table","quoted": "False"},"db": {"type": "Identifier","this": "mrl_b2p","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_tnsm_tfm_dev","quoted": "False"},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "x","quoted": "False"},"columns": "None"}},"side": "left","on": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "config_item_id","quoted": "False"},"table": {"type": "Identifier","this": "x","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Literal","this": "999","is_string": "False"}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "active_flag","quoted": "False"},"table": {"type": "Identifier","this": "x","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Literal","this": "Y","is_string": "True"}}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_study","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "SU","quoted": "False"},"columns": "None"}},"kind": "inner","on": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "SU","quoted": "False"},"db": "None","catalog": "None"}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_site","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "SI","quoted": "False"},"columns": "None"}},"kind": "inner","on": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "SI","quoted": "False"},"db": "None","catalog": "None"}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "SI","quoted": "False"},"db": "None","catalog": "None"}}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_subject","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "SBJ","quoted": "False"},"columns": "None"}},"side": "left","on": {"type": "And","this": {"type": "And","this": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_subject_visit","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"columns": "None"}},"side": "left","on": {"type": "And","this": {"type": "And","this": {"type": "And","this": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "subject_visit_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "subject_visit_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_location","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "LOC","quoted": "False"},"columns": "None"}},"side": "left","on": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "location_id","quoted": "False"},"table": {"type": "Identifier","this": "SI","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "location_id","quoted": "False"},"table": {"type": "Identifier","this": "loc","quoted": "False"},"db": "None","catalog": "None"}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "country_reference","quoted": "False"},"db": {"type": "Identifier","this": "mrl_crdr","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_clinical_test","quoted": "False"},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "ICV","quoted": "False"},"columns": "None"}},"side": "left","on": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "country_id","quoted": "False"},"table": {"type": "Identifier","this": "icv","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "country_id","quoted": "False"},"table": {"type": "Identifier","this": "loc","quoted": "False"},"db": "None","catalog": "None"}}},{"type": "Join","this": {"type": "Subquery","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Star","except": "None","replace": "None","rename": "None"},"table": {"type": "Identifier","this": "b","quoted": "False"},"db": "None","catalog": "None"}],"limit": "None","from": {"type": "From","this": {"type": "Subquery","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Alias","this": {"type": "Window","this": {"type": "RowNumber"},"partition_by": [{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"}}],"order": {"type": "Order","this": "None","expressions": [{"type": "Ordered","this": {"type": "Column","this": {"type": "Identifier","this": "occurred_on_date","quoted": "False"}},"desc": "True","nulls_first": "False","with_fill": "None"}],"siblings": "None"},"spec": "None","alias": "None","over": "OVER","first": "None"},"alias": {"type": "Identifier","this": "rank1","quoted": "False"}},{"type": "Alias","this": {"type": "Case","this": "None","ifs": [{"type": "If","this": {"type": "EQ","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "event_name","quoted": "False"}}},"expression": {"type": "Literal","this": "SUBJECT SCREENED","is_string": "True"}},"true": {"type": "Literal","this": "In Screening","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "event_name","quoted": "False"}}},"expression": {"type": "Literal","this": "SUBJECT RANDOMIZATION/TREATED","is_string": "True"}},"true": {"type": "Literal","this": "Randomized/Treated","is_string": "True"}}],"default": "None"},"alias": {"type": "Identifier","this": "subject_status_change","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_aux_del_unscheduled_visit","quoted": "False"},"db": "None","catalog": "None"}},"where": {"type": "Where","this": {"type": "And","this": {"type": "In","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "event_type","quoted": "False"}}},"expressions": [{"type": "Literal","this": "SUBJECT STATUS CHANGE","is_string": "True"}]},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"}},"expression": {"type": "Literal","this": "0","is_string": "False"}}}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "b","quoted": "False"},"columns": "None"},"sample": "None"}},"where": {"type": "Where","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "rank1","quoted": "False"},"table": {"type": "Identifier","this": "b","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Literal","this": "1","is_string": "False"}}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "subject_status","quoted": "False"},"columns": "None"},"sample": "None"},"side": "left","on": {"type": "And","this": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "subject_status","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "SU","quoted": "False"},"db": "None","catalog": "None"}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "subject_status","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "SI","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "subject_status","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "SBj","quoted": "False"},"db": "None","catalog": "None"}}}}],"where": {"type": "Where","this": {"type": "And","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "event_type","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "VISIT","is_string": "True"}},"expression": {"type": "In","this": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expressions": [{"type": "Literal","this": "DMW","is_string": "True"},{"type": "Literal","this": "DEMARC","is_string": "True"}]}}}},"distinct": "False","by_name": "None","expression": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "external_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "rec_no","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "name","quoted": "False"},"table": {"type": "Identifier","this": "SU","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "study_no","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "name","quoted": "False"},"table": {"type": "Identifier","this": "SI","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "site_no","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_screening_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "sbjct_no","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "country_name","quoted": "False"},"table": {"type": "Identifier","this": "icv","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "site_cntry","quoted": "False"}},{"type": "Alias","this": {"type": "Case","this": "None","ifs": [{"type": "If","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "SUBJECT_STATUS","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "COMPLETED","is_string": "True"}},"true": {"type": "Literal","this": "Completed","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "SCREENING NOT COMPLETED","is_string": "True"}},"true": {"type": "Literal","this": "Limited Screen Failure","is_string": "True"}},{"type": "If","this": {"type": "And","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason_category","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "DISCONTINUED","is_string": "True"}},"expression": {"type": "NEQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "SCREEN FAILURE","is_string": "True"}}},"true": {"type": "Literal","this": "Early Terminated","is_string": "True"}},{"type": "If","this": {"type": "And","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason_category","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "DISCONTINUED","is_string": "True"}},"expression": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "SCREEN FAILURE","is_string": "True"}}},"true": {"type": "Literal","this": "Screen Failed","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "SUBJECT_STATUS","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "RANDOMIZED/TREATED","is_string": "True"}},"true": {"type": "Literal","this": "Randomized/Treated","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "SUBJECT_STATUS","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "SCREENED","is_string": "True"}},"true": {"type": "Literal","this": "In Screening","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "SUBJECT_STATUS","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "N/A","is_string": "True"}},"true": {"type": "Column","this": {"type": "Identifier","this": "subject_status_change","quoted": "False"},"table": {"type": "Identifier","this": "subject_status","quoted": "False"},"db": "None","catalog": "None"}}],"default": {"type": "Column","this": {"type": "Identifier","this": "SUBJECT_STATUS","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"alias": {"type": "Identifier","this": "sbjct_sts","quoted": "False"}},{"type": "Alias","this": {"type": "Null"},"alias": {"type": "Identifier","this": "cohort_sbjct_grp","quoted": "False"}},{"type": "Alias","this": {"type": "Null"},"alias": {"type": "Identifier","this": "arm_sbjct_grp","quoted": "False"}},{"type": "Alias","this": {"type": "Null"},"alias": {"type": "Identifier","this": "vst_srv_mod","quoted": "False"}},{"type": "Alias","this": {"type": "Null"},"alias": {"type": "Identifier","this": "vst_srv_loc","quoted": "False"}},{"type": "Alias","this": {"type": "Null"},"alias": {"type": "Identifier","this": "vst_srv_prov","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "event_name","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "mlstn_id","quoted": "False"}},{"type": "Alias","this": {"type": "Cast","this": {"type": "Column","this": {"type": "Identifier","this": "occurred_on_date","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"to": {"type": "DataType","this": "Type.DATE","expressions": "None","nested": "False","prefix": "None"},"format": "None","safe": "None","action": "None"},"alias": {"type": "Identifier","this": "mlstn_compl_dt","quoted": "False"}},{"type": "Alias","this": {"type": "Literal","this": "Complete","is_string": "True"},"alias": {"type": "Identifier","this": "mlstn_stat","quoted": "False"}},{"type": "Alias","this": {"type": "Cast","this": {"type": "Null"},"to": {"type": "DataType","this": "Type.TEXT","expressions": "None","nested": "False","prefix": "None"}},"alias": {"type": "Identifier","this": "erroneous_rec","quoted": "False"}},{"type": "Alias","this": {"type": "Case","this": "None","ifs": [{"type": "If","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Literal","this": "1","is_string": "True"}},"true": {"type": "Literal","this": "Reverse","is_string": "True"}}],"default": {"type": "Literal","this": "Insert","is_string": "True"}},"alias": {"type": "Identifier","this": "rec_sts","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "event_type","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "rec_typ","quoted": "False"}},{"type": "Alias","this": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"alias": {"type": "Identifier","this": "src_sys_nm","quoted": "False"}},{"type": "Alias","this": {"type": "Bracket","this": {"type": "Bracket","this": {"type": "Column","this": {"type": "Identifier","this": "source_data","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expressions": [{"type": "Literal","this": "0","is_string": "False"}]},"expressions": [{"type": "Column","this": {"type": "Identifier","this": "name","quoted": "True"}}]},"alias": {"type": "Identifier","this": "src_tbl_nm","quoted": "False"}},{"type": "Alias","this": {"type": "Cast","this": {"type": "Literal","this": "true","is_string": "True"},"to": {"type": "DataType","this": "Type.BOOLEAN","expressions": "None","nested": "False","prefix": "None"}},"alias": {"type": "Identifier","this": "actv_flag","quoted": "False"}},{"type": "Alias","this": {"type": "Cast","this": {"type": "Column","this": {"type": "Identifier","this": "config_subitem_nm","quoted": "False"},"table": {"type": "Identifier","this": "x","quoted": "False"},"db": "None","catalog": "None"},"to": {"type": "DataType","this": "Type.TEXT","expressions": "None","nested": "False","prefix": "None"}},"alias": {"type": "Identifier","this": "crtd_by_id","quoted": "False"}},{"type": "Alias","this": {"type": "Anonymous","this": "to_timestamp","expressions": [{"type": "Column","this": {"type": "Identifier","this": "src_created_by_date","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},{"type": "Literal","this": "yyyy-MM-dd hh:mm:ss","is_string": "True"}]},"alias": {"type": "Identifier","this": "crtd_on_ts","quoted": "False"}},{"type": "Alias","this": {"type": "Anonymous","this": "to_timestamp","expressions": [{"type": "Greatest","this": {"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expressions": [{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "SU","quoted": "False"},"db": "None","catalog": "None"},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "si","quoted": "False"},"db": "None","catalog": "None"},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"},"table": {"type": "Identifier","this": "LOC","quoted": "False"},"db": "None","catalog": "None"}]},{"type": "Literal","this": "yyyy-MM-dd hh:mm:ss","is_string": "True"}]},"alias": {"type": "Identifier","this": "chgd_on_ts","quoted": "False"}},{"type": "Alias","this": {"type": "CurrentTimestamp"},"alias": {"type": "Identifier","this": "etl_load_ts","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_aux_del_procedure","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "CTE","quoted": "False"},"columns": "None"}}},"joins": [{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "b2p_config_table","quoted": "False"},"db": {"type": "Identifier","this": "mrl_b2p","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_tnsm_tfm_dev","quoted": "False"},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "x","quoted": "False"},"columns": "None"}},"side": "left","on": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "config_item_id","quoted": "False"},"table": {"type": "Identifier","this": "x","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Literal","this": "999","is_string": "False"}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "active_flag","quoted": "False"},"table": {"type": "Identifier","this": "x","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Literal","this": "Y","is_string": "True"}}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_study","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "SU","quoted": "False"},"columns": "None"}},"kind": "inner","on": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "SU","quoted": "False"},"db": "None","catalog": "None"}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_site","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "SI","quoted": "False"},"columns": "None"}},"kind": "inner","on": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "SI","quoted": "False"},"db": "None","catalog": "None"}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "SI","quoted": "False"},"db": "None","catalog": "None"}}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_subject","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "SBJ","quoted": "False"},"columns": "None"}},"side": "left","on": {"type": "And","this": {"type": "And","this": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "SBJ","quoted": "False"},"db": "None","catalog": "None"}}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_subject_visit","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"columns": "None"}},"side": "left","on": {"type": "And","this": {"type": "And","this": {"type": "And","this": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "subject_visit_id","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "subject_visit_id","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "SBJ_VST","quoted": "False"},"db": "None","catalog": "None"}}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_location","quoted": "False"},"db": "None","catalog": "None","alias": {"type": "TableAlias","this": {"type": "Identifier","this": "LOC","quoted": "False"},"columns": "None"}},"side": "left","on": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "location_id","quoted": "False"},"table": {"type": "Identifier","this": "SI","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "location_id","quoted": "False"},"table": {"type": "Identifier","this": "loc","quoted": "False"},"db": "None","catalog": "None"}}},{"type": "Join","this": {"type": "Table","this": {"type": "Identifier","this": "country_reference","quoted": "False"},"db": {"type": "Identifier","this": "mrl_crdr","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_clinical_test","quoted": "False"},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "ICV","quoted": "False"},"columns": "None"}},"side": "left","on": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "country_id","quoted": "False"},"table": {"type": "Identifier","this": "icv","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "country_id","quoted": "False"},"table": {"type": "Identifier","this": "loc","quoted": "False"},"db": "None","catalog": "None"}}},{"type": "Join","this": {"type": "Subquery","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Star","except": "None","replace": "None","rename": "None"},"table": {"type": "Identifier","this": "b","quoted": "False"},"db": "None","catalog": "None"}],"limit": "None","from": {"type": "From","this": {"type": "Subquery","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Alias","this": {"type": "Window","this": {"type": "RowNumber"},"partition_by": [{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"}}],"order": {"type": "Order","this": "None","expressions": [{"type": "Ordered","this": {"type": "Column","this": {"type": "Identifier","this": "occurred_on_date","quoted": "False"}},"desc": "True","nulls_first": "False","with_fill": "None"}],"siblings": "None"},"spec": "None","alias": "None","over": "OVER","first": "None"},"alias": {"type": "Identifier","this": "rank1","quoted": "False"}},{"type": "Alias","this": {"type": "Case","this": "None","ifs": [{"type": "If","this": {"type": "EQ","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "event_name","quoted": "False"}}},"expression": {"type": "Literal","this": "SUBJECT SCREENED","is_string": "True"}},"true": {"type": "Literal","this": "In Screening","is_string": "True"}},{"type": "If","this": {"type": "EQ","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "event_name","quoted": "False"}}},"expression": {"type": "Literal","this": "SUBJECT RANDOMIZATION/TREATED","is_string": "True"}},"true": {"type": "Literal","this": "Randomized/Treated","is_string": "True"}}],"default": "None"},"alias": {"type": "Identifier","this": "subject_status_change","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_aux_del_procedure","quoted": "False"},"db": "None","catalog": "None"}},"where": {"type": "Where","this": {"type": "And","this": {"type": "In","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "event_type","quoted": "False"}}},"expressions": [{"type": "Literal","this": "SUBJECT STATUS CHANGE","is_string": "True"}]},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"}},"expression": {"type": "Literal","this": "0","is_string": "False"}}}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "b","quoted": "False"},"columns": "None"},"sample": "None"}},"where": {"type": "Where","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "rank1","quoted": "False"},"table": {"type": "Identifier","this": "b","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Literal","this": "1","is_string": "False"}}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "subject_status","quoted": "False"},"columns": "None"},"sample": "None"},"side": "left","on": {"type": "And","this": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "subject_status","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"},"table": {"type": "Identifier","this": "SU","quoted": "False"},"db": "None","catalog": "None"}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "subject_status","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"},"table": {"type": "Identifier","this": "SI","quoted": "False"},"db": "None","catalog": "None"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "subject_status","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"},"table": {"type": "Identifier","this": "SBj","quoted": "False"},"db": "None","catalog": "None"}}}}],"where": {"type": "Where","this": {"type": "And","this": {"type": "EQ","this": {"type": "Trim","this": {"type": "Upper","this": {"type": "Column","this": {"type": "Identifier","this": "event_type","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"}},"position": "None","expression": "None","collation": "None"},"expression": {"type": "Literal","this": "PROCEDURE","is_string": "True"}},"expression": {"type": "In","this": {"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"},"table": {"type": "Identifier","this": "CTE","quoted": "False"},"db": "None","catalog": "None"},"expressions": [{"type": "Literal","this": "DMW","is_string": "True"},{"type": "Literal","this": "DEMARC","is_string": "True"}]}}}}},"distinct": "False","by_name": "None","expression": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Identifier","this": "rec_no","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_no","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_no","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "sbjct_no","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_cntry","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "sbjct_sts","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "cohort_sbjct_grp","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "arm_sbjct_grp","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "vst_srv_mod","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "vst_srv_loc","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "vst_srv_prov","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "mlstn_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "mlstn_compl_dt","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "mlstn_stat","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "erroneous_rec","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "rec_sts","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "rec_typ","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_sys_nm","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_tbl_nm","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "actv_flag","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "crtd_by_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "crtd_on_ts","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "chgd_on_ts","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "etl_load_ts","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Subquery","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Identifier","this": "rec_no","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "visit_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_no","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_no","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "sbjct_no","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_cntry","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "sbjct_sts","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "sbjct_vst_typ","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "sbjct_vst_nm","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "cohort_sbjct_grp","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "arm_sbjct_grp","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "vst_srv_mod","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "vst_srv_loc","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "vst_srv_prov","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "mlstn_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "mlstn_compl_dt","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "mlstn_stat","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "erroneous_rec","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "rec_sts","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "rec_typ","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_sys_nm","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_tbl_nm","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "actv_flag","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "crtd_by_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "crtd_on_ts","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "chgd_on_ts","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "etl_load_ts","quoted": "False"}},{"type": "Alias","this": {"type": "Window","this": {"type": "Anonymous","this": "dense_rank","expressions": []},"partition_by": [{"type": "Column","this": {"type": "Identifier","this": "study_no","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_no","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "sbjct_no","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "mlstn_id","quoted": "False"}}],"order": {"type": "Order","this": "None","expressions": [{"type": "Ordered","this": {"type": "Column","this": {"type": "Identifier","this": "crtd_on_ts","quoted": "False"}},"desc": "False","nulls_first": "True","with_fill": "None"}],"siblings": "None"},"spec": "None","alias": "None","over": "OVER","first": "None"},"alias": {"type": "Identifier","this": "rnk","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "modified_by_date","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "edc_pymt_collapsed_vst","quoted": "False"},"db": {"type": "Identifier","this": "mrl_b2p","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_tnsm_tfm_dev","quoted": "False"},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "a","quoted": "False"},"columns": "None"}}}},"alias": "None","sample": "None"}},"where": {"type": "Where","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "rnk","quoted": "False"}},"expression": {"type": "Literal","this": "1","is_string": "False"}}}},"with": {"type": "With","expressions": [{"type": "CTE","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Alias","this": {"type": "Max","this": {"type": "Column","this": {"type": "Identifier","this": "run_started_at","quoted": "False"}},"expressions": []},"alias": {"type": "Identifier","this": "last_invocation_date","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "dbt_invocations","quoted": "False"},"db": {"type": "Identifier","this": "monitoring","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_tnsm_tfm_dev","quoted": "False"},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "a","quoted": "False"},"columns": "None"}}},"joins": [{"type": "Join","this": {"type": "Subquery","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Identifier","this": "invocation_id","quoted": "False"}},{"type": "Alias","this": {"type": "Min","this": {"type": "Case","this": "None","ifs": [{"type": "If","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "status","quoted": "False"}},"expression": {"type": "Literal","this": "success","is_string": "True"}},"true": {"type": "Literal","this": "1","is_string": "False"}}],"default": {"type": "Literal","this": "0","is_string": "False"}},"expressions": []},"alias": {"type": "Identifier","this": "invocation_status","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "dbt_run_results","quoted": "False"},"db": {"type": "Identifier","this": "monitoring","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_tnsm_tfm_dev","quoted": "False"}}},"where": {"type": "Where","this": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "resource_type","quoted": "False"}},"expression": {"type": "Literal","this": "model","is_string": "True"}},"expression": {"type": "Not","this": {"type": "Like","this": {"type": "Column","this": {"type": "Identifier","this": "unique_id","quoted": "False"}},"expression": {"type": "Literal","this": "model.elementary%","is_string": "True"}}}}},"group": {"type": "Group","expressions": [{"type": "Literal","this": "1","is_string": "False"}]}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "b","quoted": "False"},"columns": "None"},"sample": "None"},"on": {"type": "And","this": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "invocation_id","quoted": "False"},"table": {"type": "Identifier","this": "a","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Column","this": {"type": "Identifier","this": "invocation_id","quoted": "False"},"table": {"type": "Identifier","this": "b","quoted": "False"},"db": "None","catalog": "None"}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "invocation_status","quoted": "False"},"table": {"type": "Identifier","this": "b","quoted": "False"},"db": "None","catalog": "None"},"expression": {"type": "Literal","this": "1","is_string": "False"}}}}],"where": {"type": "Where","this": {"type": "And","this": {"type": "And","this": {"type": "In","this": {"type": "Column","this": {"type": "Identifier","this": "command","quoted": "False"}},"expressions": [{"type": "Literal","this": "run","is_string": "True"},{"type": "Literal","this": "build","is_string": "True"}]},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "target_schema","quoted": "False"}},"expression": {"type": "Literal","this": "mrl_b2p","is_string": "True"}}},"expression": {"type": "EQ","this": {"type": "Column","this": {"type": "Identifier","this": "yaml_selector","quoted": "False"}},"expression": {"type": "Literal","this": "b2p","is_string": "True"}}}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "__dbt__cte__b2p_aux_last_invocation_dt","quoted": "False"},"columns": "None"},"materialized": "None"},{"type": "CTE","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Identifier","this": "clinical_trial_event_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "external_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_visit_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "event_name","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "occurred_on_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "event_type","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_sp","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "source_data","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "clinical_trial_event","quoted": "False"},"db": {"type": "Identifier","this": "mrl_odm","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_clinical_test","quoted": "False"}}},"qualify": {"type": "Qualify","this": {"type": "EQ","this": {"type": "Window","this": {"type": "RowNumber"},"partition_by": [{"type": "Column","this": {"type": "Identifier","this": "external_id","quoted": "False"}}],"order": {"type": "Order","this": "None","expressions": [{"type": "Ordered","this": {"type": "Greatest","this": {"type": "Column","this": {"type": "Identifier","this": "modified_by_date","quoted": "False"}},"expressions": [{"type": "Column","this": {"type": "Identifier","this": "created_on","quoted": "False"}}]},"desc": "True","nulls_first": "False","with_fill": "None"}],"siblings": "None"},"spec": "None","alias": "None","over": "OVER","first": "None"},"expression": {"type": "Literal","this": "1","is_string": "False"}}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_clinical_trial_event","quoted": "False"},"columns": "None"},"materialized": "None"},{"type": "CTE","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Identifier","this": "external_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_visit_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "event_name","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "occurred_on_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "event_type","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "source_data","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "modified_by_date","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_clinical_trial_event","quoted": "False"},"db": "None","catalog": "None"}},"where": {"type": "Where","this": {"type": "In","this": {"type": "Upper","this": {"type": "Trim","this": {"type": "Column","this": {"type": "Identifier","this": "event_type","quoted": "False"}},"position": "None","expression": "None","collation": "None"}},"expressions": [{"type": "Literal","this": "VISIT","is_string": "True"},{"type": "Literal","this": "SUBJECT STATUS CHANGE","is_string": "True"}]}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "__dbt__cte__b2p_aux_del_unscheduled_visit","quoted": "False"},"columns": "None"},"materialized": "None"},{"type": "CTE","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "external_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "name","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "termination_flag","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "managing_area1","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "trial_type","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "sponsor_type","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_phase","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "clinical_trialsgov_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "therapy_area","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "state","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "eudract","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "euct_number","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "whoutn_number","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "indication_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "product_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "protocol_long_title","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "protocol_title","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "recruitment_planning_frequency","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "study","quoted": "False"},"db": {"type": "Identifier","this": "mrl_odm","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_clinical_test","quoted": "False"}}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_study","quoted": "False"},"columns": "None"},"materialized": "None"},{"type": "CTE","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "external_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "name","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "state","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "public_contact_phone_number","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "location_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_country_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "principal_investigator_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "organization_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "site","quoted": "False"},"db": {"type": "Identifier","this": "mrl_odm","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_clinical_test","quoted": "False"}}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_site","quoted": "False"},"columns": "None"},"materialized": "None"},{"type": "CTE","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_arm","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_cohort","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "name","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "legacy_screening_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_status","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "legacy_discontinued_reason_category","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "subject","quoted": "False"},"db": {"type": "Identifier","this": "mrl_odm","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_clinical_test","quoted": "False"}}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_subject","quoted": "False"},"columns": "None"},"materialized": "None"},{"type": "CTE","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Identifier","this": "subject_visit_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "visit_type","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "visit_def_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "visit_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "sdv_mode","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "legacy_visit_mode","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "legacy_visit_location","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "legacy_visit_srv_prov","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "erroneous_visit","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "subject_visit","quoted": "False"},"db": {"type": "Identifier","this": "mrl_odm","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_clinical_test","quoted": "False"}}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_subject_visit","quoted": "False"},"columns": "None"},"materialized": "None"},{"type": "CTE","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Identifier","this": "location_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "external_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "address_line_1","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "address_line_2","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "address_line_3","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "state_province_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "country_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "postal_zip_code","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "town_city","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "phone_number","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "location","quoted": "False"},"db": {"type": "Identifier","this": "mrl_odm","quoted": "False"},"catalog": {"type": "Identifier","this": "mrl_clinical_test","quoted": "False"}}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_location","quoted": "False"},"columns": "None"},"materialized": "None"},{"type": "CTE","this": {"type": "Select","kind": "None","hint": "None","distinct": "None","expressions": [{"type": "Column","this": {"type": "Identifier","this": "external_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "study_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "site_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "subject_visit_id","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "event_name","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "occurred_on_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "event_type","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "source_system","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "source_data","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "delete_flag","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_created_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "src_modified_by_date","quoted": "False"}},{"type": "Column","this": {"type": "Identifier","this": "modified_by_date","quoted": "False"}}],"limit": "None","from": {"type": "From","this": {"type": "Table","this": {"type": "Identifier","this": "__dbt__cte__b2p_int_clinical_trial_event","quoted": "False"},"db": "None","catalog": "None"}},"where": {"type": "Where","this": {"type": "In","this": {"type": "Upper","this": {"type": "Trim","this": {"type": "Column","this": {"type": "Identifier","this": "event_type","quoted": "False"}},"position": "None","expression": "None","collation": "None"}},"expressions": [{"type": "Literal","this": "PROCEDURE","is_string": "True"},{"type": "Literal","this": "SUBJECT STATUS CHANGE","is_string": "True"}]}}},"alias": {"type": "TableAlias","this": {"type": "Identifier","this": "__dbt__cte__b2p_aux_del_procedure","quoted": "False"},"columns": "None"},"materialized": "None"}],"recursive": "None"}}
